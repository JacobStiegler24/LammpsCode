LAMMPS (29 Aug 2024 - Update 3)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:99)
  using 1 OpenMP thread(s) per MPI task
############################################################################################
# Variables
# sigma = 22.25 nm
# epsilon = 2.25E-20 J
# 1 lj force unit = 1 pN
# 1 lj spring constant = 0.5 micro N/m
# variable K_r equal 4.1535
# variable K_r_prime equal 10
variable R0 equal 1
variable R0_prime equal 2
# variable K_theta equal 7.785
# variable stretch_force equal 10.0
variable unfold_critical_distance equal 1.25
variable fold_critical_distance equal 1
variable reaction_upperbound equal 50
variable temp equal 1.0

variable run_no equal 1000000
variable time_step equal 0.0001   # time step in picoseconds
# variable seed equal 54654652     # random number seed
variable dumpfreq equal 100
#########################################################################################

units lj                # Lennard-Jones units
atom_style angle        # atoms with bonds and angles

boundary p p p          # all boundaries are periodic

neighbor 1.9 bin
neigh_modify every 1 delay 1 check yes

read_data initial_configuration.txt
Reading data file ...
  orthogonal box = (0 0 0) to (100 100 1000)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  3 atoms
  scanning bonds ...
  1 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  orthogonal box = (0 0 0) to (100 100 1000)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  2 bonds
  reading angles ...
  1 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.002 seconds

labelmap atom 1 D 2 E
labelmap bond 1 fold 2 unfold

#labelmap atom 1 D 2 E
group reaction_group id 1
1 atoms in group reaction_group
group extension_group id 3
1 atoms in group extension_group
group motion_group id 2 3
2 atoms in group motion_group
group rxn-group type D E
3 atoms in group rxn-group

pair_style lj/cut 10.0
pair_coeff * * 0.0 0.0

bond_style hybrid harmonic fene         # harmonic bond
bond_coeff 1 harmonic ${K_r} ${R0}     # args: bond type, bond style, K, R0
bond_coeff 1 harmonic 4.1535 ${R0}     
bond_coeff 1 harmonic 4.1535 1     
bond_coeff 2 fene ${K_r_prime} ${R0_prime} 0.0 1.0     # args: bond type, bond style, K, R0, epsilon, sigma
bond_coeff 2 fene 31.0 ${R0_prime} 0.0 1.0     
bond_coeff 2 fene 31.0 2 0.0 1.0     

# bond_style harmonic       # harmonic bond
# bond_coeff 1 ${K_r} ${R0}
# bond_coeff 2 ${K_r_prime} ${R0_prime}

angle_style harmonic             # harmonic bond angular component
angle_coeff 1 ${K_theta} 180.0   # args: angle type, K, theta0
angle_coeff 1 7.785 180.0   

#exclude atom 1
fix 1 motion_group nve                           # NVE integrator
fix 2 motion_group langevin ${temp} ${temp} 1.0 ${seed}  # Langevin thermostat
fix 2 motion_group langevin 1 ${temp} 1.0 ${seed}  
fix 2 motion_group langevin 1 1 1.0 ${seed}  
fix 2 motion_group langevin 1 1 1.0 54654685  

# variable fz equal ramp(0,${stretch_force})
# fix extension_force extension_group addforce 0.0 0.0 v_fz
fix extension_force extension_group addforce 0.0 0.0 ${stretch_force}
fix extension_force extension_group addforce 0.0 0.0 0.0

############################################################################################
# chatgpt, explain the terms
#fix keepcenter all recenter INIT INIT INIT
############################################################################################

timestep ${time_step}                        # time step in picoseconds
timestep 0.0001                        

############################################################################################
# Print to file commands
compute bondlen all bond/local dist
compute btype all property/local btype
dump bondlen_dump extension_group local ${dumpfreq} ${outdir}/bondlengths.dump c_btype c_bondlen
dump bondlen_dump extension_group local 100 ${outdir}/bondlengths.dump c_btype c_bondlen
dump bondlen_dump extension_group local 100 output/CORRuu/k_r_prime31.0_Seed54654685/bondlengths.dump c_btype c_bondlen

compute myAngle all angle/local theta
dump angle_dump all local ${dumpfreq} ${outdir}/angles.dump c_myAngle
dump angle_dump all local 100 ${outdir}/angles.dump c_myAngle
dump angle_dump all local 100 output/CORRuu/k_r_prime31.0_Seed54654685/angles.dump c_myAngle

dump dum1 all custom ${dumpfreq} ${outdir}/dum1.dump id type x y z ix iy iz #look into generating folder
dump dum1 all custom 100 ${outdir}/dum1.dump id type x y z ix iy iz 
dump dum1 all custom 100 output/CORRuu/k_r_prime31.0_Seed54654685/dum1.dump id type x y z ix iy iz 
write_data ${outdir}/datafile.data
write_data output/CORRuu/k_r_prime31.0_Seed54654685/datafile.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Use special bonds = 0,1,1 with bond style fene (src/MOLECULE/bond_fene.cpp:185)
Neighbor list info ...
  update: every = 1 steps, delay = 1 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11.9
  ghost atom cutoff = 11.9
  binsize = 5.95, bins = 17 17 169
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Not all mixed pair coeffs generated from mixing. Use write_data with 'pair ij' option to store all pair coeffs. (src/write_data.cpp:364)

# group D1 id 1
# group D2 id 3
# group E id 2

# compute cD1 D1 com
# compute cD2 D2 com
# compute cE  E  com


# variable dx1 equal c_cD1[1]-c_cE[1]
# variable dy1 equal c_cD1[2]-c_cE[2]
# variable dz1 equal c_cD1[3]-c_cE[3]
# variable dx2 equal c_cD2[1]-c_cE[1]
# variable dy2 equal c_cD2[2]-c_cE[2]
# variable dz2 equal c_cD2[3]-c_cE[3]
# variable RE equal sqrt(v_dx1*v_dx1+v_dy1*v_dy1+v_dz1*v_dz1) #+ sqrt(v_dx2*v_dx2+v_dy2*v_dy2+v_dz2*v_dz2)

# fix myRG2file all print 100 "${RE}  "  file ${outdir}/bond_length.out screen no
############################################################################################

############################################################################################
# Molecule change for unfolding/folding

# molecule folded m_folded.txt
# molecule unfolded m_unfolded.txt
# molecule D1E2D m_D1E2D.txt
# molecule D2E1D m_D2E1D.txt

# # test without unfolding for angular bond
# fix rxn1 all bond/react #   react DEUnfold all 1 ${unfold_critical_distance} ${reaction_upperbound} folded D2E1D mapDE.txt prob 0.5 ${seed} #   react EDUnfold all 1 ${unfold_critical_distance} ${reaction_upperbound} folded D1E2D mapED.txt prob 0.5 ${seed} #   react DEUnfoldFull all 1 ${unfold_critical_distance} ${reaction_upperbound} D1E2D unfolded mapDE.txt prob 0.5 ${seed} #   react EDUnfoldFull all 1 ${unfold_critical_distance} ${reaction_upperbound} D2E1D unfolded mapED.txt prob 0.5 ${seed} ##   react DEFold all 1 0 ${fold_critical_distance} unfolded D1E2D mapDE.txt prob 0.5 ${seed} #   react EDFold all 1 0 ${fold_critical_distance} unfolded D2E1D mapED.txt prob 0.5 ${seed} #   react DEFoldFull all 1 0 ${fold_critical_distance} D2E1D folded mapDE.txt prob 0.5 ${seed} #   react EDFoldFull all 1 0 ${fold_critical_distance} D1E2D folded mapED.txt prob 0.5 ${seed}


# molecule fold m_fold.txt
# molecule unfold m_unfold.txt

# # fix rxn2 all bond/react #   react rxn-unfold all 1 ${unfold_critical_distance} ${reaction_upperbound} fold unfold map.txt prob 0.5 ${seed} #   react rxn-fold all 1 0 ${fold_critical_distance} unfold fold map.txt prob 0.1 ${seed}

############################################################################################

run ${run_no}
run 1000000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282â€“-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Use special bonds = 0,1,1 with bond style fene (src/MOLECULE/bond_fene.cpp:185)
Per MPI rank memory allocation (min/avg/max) = 5.573 | 5.573 | 5.573 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              11.890859      11.890859     -2.7555556e-06
   1000000   0.23026969     0              1.9383759      2.1686456     -3.4086405e-07
Loop time of 0.776518 on 1 procs for 1000000 steps with 3 atoms

Performance: 11126596.182 tau/day, 1287800.484 timesteps/s, 3.863 Matom-step/s
93.8% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.037211   | 0.037211   | 0.037211   |   0.0 |  4.79
Bond    | 0.14483    | 0.14483    | 0.14483    |   0.0 | 18.65
Neigh   | 0.0023134  | 0.0023134  | 0.0023134  |   0.0 |  0.30
Comm    | 0.16799    | 0.16799    | 0.16799    |   0.0 | 21.63
Output  | 0.10207    | 0.10207    | 0.10207    |   0.0 | 13.14
Modify  | 0.19424    | 0.19424    | 0.19424    |   0.0 | 25.01
Other   |            | 0.1279     |            |       | 16.47

Nlocal:              3 ave           3 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:             21 ave          21 max          21 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 2
Neighbor list builds = 56
Dangerous builds = 0

# unfix extension_force

# run ${run_no}  # run again to allow the system to relax after the reactions

write_restart final.restart
System init for write_restart ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Use special bonds = 0,1,1 with bond style fene (src/MOLECULE/bond_fene.cpp:185)

# statistics
# file structure
# angular potential
# folding/unfolding efficiency
Total wall time: 0:00:00
